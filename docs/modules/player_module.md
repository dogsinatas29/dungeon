# 모듈 상세: player.py

`player.py` 모듈은 게임의 주인공인 플레이어 캐릭터(`Player` 클래스)의 모든 상태, 행동, 상호작용을 관리합니다.

## 1. 주요 기능 및 책임

-   **플레이어 상태 관리**: HP, MP, 공격력, 방어력, 레벨, 경험치, 위치 등 플레이어의 모든 현재 스탯과 상태를 저장합니다.
-   **이동 로직**: 플레이어의 맵 상에서의 이동을 처리하고, 유효성 검사(벽 통과 불가, 맵 경계)를 수행합니다.
-   **경험치 및 레벨업**: 몬스터 처치 시 경험치 획득, 레벨업 조건 확인 및 스탯 성장 로직을 포함합니다.
-   **장비 및 아이템 관리 (향후)**: 인벤토리, 장비 슬롯, 아이템 사용 및 장비 장착/해제 로직을 구현할 예정입니다.
-   **데이터 직렬화/역직렬화**: 게임 저장/로드 시 플레이어 데이터를 JSON 형식으로 변환(`to_dict`)하고 복원(`from_dict`)하는 메서드를 제공합니다.

## 2. 핵심 클래스 및 속성 상세

### `Player` 클래스

-   **목적**: 플레이어 캐릭터의 모든 속성과 메서드를 캡슐화합니다.
-   **주요 속성**:
    -   `hp`, `mp`, `att`, `def`: 현재 스탯.
    -   `max_hp`, `max_mp`: 최대 스탯 (레벨업, 장비 등으로 변동).
    -   `x`, `y`: 맵 상의 현재 위치.
    -   `lv`: 현재 레벨.
    -   `exp`: 현재 경험치.
    -   `exp_to_next_level`: 다음 레벨업에 필요한 경험치.
    -   `inventory`: 플레이어가 소지한 아이템 목록 (향후 구현).
    -   `equipment`: 플레이어가 장착한 장비 목록 (향후 구현).
-   **디자인 결정**: 플레이어의 모든 상태는 이 클래스 내에서 관리되어야 합니다. 다른 모듈은 `Player` 객체를 통해 플레이어의 상태에 접근하고 변경해야 합니다.

## 3. 핵심 메서드 상세

### `__init__(self, ...)`

-   **목적**: `Player` 객체 초기화. 기본 스탯, 위치, 경험치 등을 설정합니다.

### `move(self, dx, dy, dungeon_map)`

-   **목적**: 플레이어를 지정된 방향(`dx`, `dy`)으로 이동시킵니다.
-   **구현 상세**:
    -   새로운 위치 계산.
    -   맵 경계 및 벽 충돌 검사 (`dungeon_map` 객체 사용).
    -   실제 위치 업데이트.
    -   이동 후 몬스터와의 충돌, 출구 도달 여부 등 게임 로직과의 연동.

### `gain_exp(self, amount)`

-   **목적**: 경험치를 획득하고 레벨업을 처리합니다.
-   **구현 상세**:
    -   `exp` 증가.
    -   `exp >= exp_to_next_level`인 경우 `level_up()` 메서드 호출.

### `level_up(self)`

-   **목적**: 플레이어의 레벨을 올리고 스탯을 증가시킵니다.
-   **구현 상세**:
    -   `lv` 증가.
    -   `exp_to_next_level` 재계산 (레벨업에 필요한 경험치 증가).
    -   `max_hp`, `max_mp`, `att`, `def` 등 스탯 증가 로직.
    -   체력/마력 회복 (선택 사항).

### `to_dict(self)` / `from_dict(cls, data)`

-   **목적**: 플레이어 객체를 JSON 저장 가능한 딕셔너리 형태로 변환하고, 딕셔너리에서 플레이어 객체를 복원합니다.
-   **주의 사항**: 플레이어 스탯이나 인벤토리 구조가 변경될 때마다 이 메서드들을 함께 수정하여 저장 파일과의 하위 호환성을 유지해야 합니다.

## 4. 다른 모듈과의 상호작용

-   **`game.py`**: 메인 게임 루프에서 플레이어의 이동 입력 처리, 몬스터와의 충돌 검사, 출구 도달 검사 등을 위해 `Player` 객체의 메서드를 호출합니다.
-   **`dungeon_map.py`**: 플레이어의 위치를 맵에 표시하고, 이동 가능한지 검사할 때 맵 정보를 참조합니다.
-   **`ui.py`**: 플레이어의 현재 스탯, 인벤토리 등을 화면에 렌더링하기 위해 `Player` 객체의 속성에 접근합니다.
-   **`combat.py` (향후)**: 전투 발생 시 플레이어의 공격력, 방어력, 체력 등을 참조하고 변경합니다.

## 5. 잠재적 문제 및 고려 사항

-   **스탯 밸런싱**: 레벨업 시 스탯 증가량, 아이템 효과 등이 게임 밸런스에 미치는 영향을 지속적으로 조정해야 합니다.
-   **인벤토리/장비 관리 복잡성**: 아이템 종류, 장착 부위, 수량 관리 등 복잡한 로직이 추가될 예정이므로, 신중한 설계가 필요합니다.
-   **직렬화 버전 관리**: `to_dict`/`from_dict` 메서드 변경 시, 이전 버전의 저장 파일을 로드할 수 있도록 버전 관리 로직을 추가할 수 있습니다.

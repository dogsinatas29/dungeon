# 모듈 상세: data_manager.py

`data_manager.py` 모듈은 게임의 다양한 데이터를 외부 파일(주로 텍스트 또는 JSON)에서 로드하고 관리하는 역할을 담당합니다. 이 모듈은 게임의 확장성과 데이터 무결성을 보장하는 데 핵심적입니다.

## 1. 주요 기능 및 책임

-   **게임 데이터 로딩**: 몬스터 정의, 아이템 정의 등 게임에 필요한 정적 데이터를 외부 파일에서 읽어 메모리에 로드합니다.
-   **데이터 파싱**: 로드된 텍스트/JSON 데이터를 게임 로직에서 사용 가능한 Python 객체(예: `MonsterDefinition`, `ItemDefinition`)로 변환합니다.
-   **데이터 접근 인터페이스**: 다른 모듈이 특정 ID나 기준으로 데이터를 쉽게 조회할 수 있는 함수를 제공합니다.
-   **저장/로드 (선택 사항)**: 게임 저장/로드 기능을 담당할 경우, JSON 직렬화/역직렬화 로직도 포함될 수 있습니다. (현재는 `player.py`, `dungeon_map.py`에 있음)

## 2. 데이터 파일 형식 및 경로

-   **`monster_data.txt`**:
    -   **경로**: `game_data/monster_data.txt`
    -   **형식**: 각 줄이 몬스터 하나의 정의를 나타내며, 쉼표(`,`)로 구분된 CSV 형식입니다.
    -   **필드**: `ID,이름,HP,ATT,DEF,LV,EXP_GIVEN`
    -   **파싱 로직**: `load_monster_definitions` 함수에서 이 형식을 파싱합니다. 새로운 필드가 추가되거나 순서가 변경될 경우, 이 함수의 파싱 로직을 함께 수정해야 합니다.

## 3. 핵심 클래스 및 함수 상세

### `MonsterDefinition` 클래스

-   **목적**: `monster_data.txt`에서 로드된 몬스터의 정적 속성을 저장하는 데이터 클래스입니다.
-   **속성**: `id`, `name`, `hp`, `att`, `def`, `lv`, `exp_given`
-   **디자인 결정**: 이 클래스는 몬스터의 '정의'일 뿐, 게임 내에서 실제 움직이는 '인스턴스'는 `monster.py`의 `Monster` 클래스입니다.

### `load_monster_definitions()` 함수

-   **목적**: `monster_data.txt` 파일을 읽어 모든 몬스터 정의를 로드하고 딕셔너리 형태로 반환합니다 (`{monster_id: MonsterDefinition}`).
-   **구현 상세**: 파일이 없거나 형식이 잘못되었을 때의 예외 처리 로직을 포함합니다.
-   **성능 고려 사항**: 게임 시작 시 한 번만 호출되어야 하며, 데이터 양이 많아질 경우 로딩 성능을 최적화할 필요가 있습니다.

### `get_monster_definition(monster_id)` 함수

-   **목적**: 로드된 몬스터 정의 딕셔너리에서 특정 `monster_id`에 해당하는 `MonsterDefinition` 객체를 반환합니다.
-   **구현 상세**: 존재하지 않는 ID 요청 시 `None` 또는 예외를 반환합니다.

## 4. 다른 모듈과의 상호작용

-   **`monster.py`**: `Monster` 클래스의 `__init__` 메서드에서 `data_manager.get_monster_definition()`을 호출하여 몬스터의 기본 스탯을 초기화합니다.
-   **`dungeon_map.py`**: `place_monsters()` 함수에서 `data_manager.load_monster_definitions()`을 호출하여 몬스터 정의를 가져온 후 맵에 몬스터를 배치합니다.
-   **`game.py`**: 게임 시작 시 `data_manager.load_monster_definitions()`를 호출하여 전체 몬스터 정의를 로드합니다.

## 5. 잠재적 문제 및 고려 사항

-   **데이터 유효성 검사**: 로드된 데이터의 유효성을 더 철저히 검사하는 로직이 필요할 수 있습니다 (예: 스탯이 음수가 아닌지, ID 중복 여부).
-   **데이터 업데이트**: 게임 실행 중 데이터 파일이 변경될 경우, 캐시를 무효화하고 다시 로드하는 메커니즘이 필요할 수 있습니다 (현재는 게임 재시작 시에만 로드).
-   **새로운 데이터 타입 추가**: 아이템, 스킬 등 새로운 게임 데이터 타입을 추가할 경우, `data_manager.py`에 해당 데이터를 로드하고 파싱하는 새로운 함수와 정의 클래스를 추가해야 합니다.
